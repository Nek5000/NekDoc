<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Periodic Hill &mdash; Nek5000  documentation</title><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Nek5000
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../problem_setup.html">Problem Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Nek Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">Build Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix.html">Appendices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Nek5000</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Periodic Hill</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/tutorials/perhill_old.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="periodic-hill">
<span id="perhill-old"></span><h1>Periodic Hill<a class="headerlink" href="#periodic-hill" title="Permalink to this headline">¶</a></h1>
<p>This tutorial will describe how to run a case from scratch.
We illustrate this procedure through a relatively simple example involving incompressible laminar flow in a two-dimensional periodic hill domain.
Our implementation is loosely based on the case presented by Mellen et al. <a class="reference internal" href="../references.html#mellen2000" id="id1">[Mellen2000]</a>.
A thorough review for this case can be found in the <a class="reference external" href="http://qnet-ercoftac.cfms.org.uk/w/index.php/Abstr:2D_Periodic_Hill_Flow">ERCOFTAC</a> knowledge base wiki.</p>
<div class="section" id="pre-processing">
<h2>Pre-processing<a class="headerlink" href="#pre-processing" title="Permalink to this headline">¶</a></h2>
<p>We assume that you have installed Nek5000 in your home directory.
This tutorial requires that you have the tools <code class="docutils literal notranslate"><span class="pre">genbox</span></code> and <code class="docutils literal notranslate"><span class="pre">genmap</span></code> compiled.
Make sure <code class="docutils literal notranslate"><span class="pre">$HOME/Nek5000/bin</span></code> is in your search PATH.</p>
<p>Cases are setup in Nek5000 by editing case files. Users should select an editor of choice with which to do this (e.g vi). A case being simulated involves data for mesh, parameters, etc. As a first step, the user should create a case directory in their run directory.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">cd</span> <span class="nv">$HOME</span>/Nek5000/run
<span class="gp">$</span> mkdir hillp
<span class="gp">$</span> <span class="nb">cd</span> hillp
</pre></div>
</div>
</div>
<div class="section" id="mesh-generation">
<h2>Mesh generation<a class="headerlink" href="#mesh-generation" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial we use a simple box mesh generated by
<code class="docutils literal notranslate"><span class="pre">genbox</span></code> with the following input file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="mi">2</span>                     <span class="n">spatial</span> <span class="n">dimension</span> <span class="p">(</span><span class="n">will</span> <span class="n">create</span> <span class="n">box</span><span class="o">.</span><span class="n">re2</span><span class="p">)</span>
<span class="mi">1</span>                      <span class="n">number</span> <span class="n">of</span> <span class="n">fields</span>
<span class="c1">#</span>
<span class="c1">#    comments: two dimensional periodic hill</span>
<span class="c1">#</span>
<span class="c1">#========================================================</span>
<span class="c1">#</span>
<span class="n">Box</span>                                       <span class="n">hillp</span>
<span class="o">-</span><span class="mi">22</span> <span class="mi">8</span>                                     <span class="n">Nelx</span>  <span class="n">Nely</span>
<span class="mf">0.0</span> <span class="mf">9.0</span> <span class="mf">1.</span>                                <span class="n">x0</span> <span class="n">x1</span> <span class="n">ratio</span>
<span class="mf">0.0</span> <span class="mf">0.1</span> <span class="mf">0.25</span> <span class="mf">0.5</span> <span class="mf">1.5</span> <span class="mf">2.5</span> <span class="mf">2.75</span> <span class="mf">2.9</span> <span class="mf">3.0</span>     <span class="n">y0</span> <span class="n">y1</span> <span class="o">...</span> <span class="n">y8</span>
<span class="n">P</span>  <span class="p">,</span><span class="n">P</span>  <span class="p">,</span><span class="n">W</span>  <span class="p">,</span><span class="n">W</span>                             <span class="n">BC</span><span class="s1">&#39;s:  (cbx0, cbx1, cby0, cby1)</span>
</pre></div>
</div>
<p>For this mesh we are specifying 22 uniform elements in the stream-wise (x) direction.
8 non-uniform elements are specified in the span-wise (y) direction in order to resolve the boundary layers.
The boundary conditions are periodic in the x-direction and no-slip in the y.
Additional details on generating meshes using <code class="docutils literal notranslate"><span class="pre">genbox</span></code> can be found <a class="reference internal" href="../tools/genbox.html#tools-genbox"><span class="std std-ref">here</span></a>. Now we can run genbox with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> genbox
</pre></div>
</div>
<p>On input provide the input file name (e.g. <code class="docutils literal notranslate"><span class="pre">hillp.box</span></code>).
The tool will produce a binary mesh and boundary data file <code class="docutils literal notranslate"><span class="pre">box.re2</span></code> which should be renamed to <code class="docutils literal notranslate"><span class="pre">hillp.re2</span></code>.</p>
</div>
<div class="section" id="usr-file">
<h2>usr file<a class="headerlink" href="#usr-file" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../problem_setup/usr_file.html#case-files-usr"><span class="std std-ref">user file</span></a> implements various subroutines to allow the user to interact with the solver.</p>
<p>To get started we copy the template to our case directory</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cp <span class="nv">$HOME</span>/Nek5000/core/zero.usr hillp.usr
</pre></div>
</div>
<div class="section" id="modify-mesh-and-apply-mass-flux">
<h3>Modify mesh and apply mass flux<a class="headerlink" href="#modify-mesh-and-apply-mass-flux" title="Permalink to this headline">¶</a></h3>
<p>To drive the flow a mass flux is applied such that  bulk velocity <span class="math notranslate nohighlight">\(u_b=1\)</span>.</p>
<p>For a periodic hill, we will need to modify the geometry.  Let <span class="math notranslate nohighlight">\({\bf x} := (x,y)\)</span> denote the old geometry, and <span class="math notranslate nohighlight">\({\bf x}' := (x',y')\)</span> denote the new geometry.  For a domain
with <span class="math notranslate nohighlight">\(y\in [0,3]\)</span> and <span class="math notranslate nohighlight">\(x\in [0,9]\)</span> the following function will map the straight pipe geometry to a periodic hill:</p>
<div class="math notranslate nohighlight">
\[y'(x,y) = y + C(3-y)\Big\{1+\tanh\big[B(|x-A|-B)\big]\Big\} .\]</div>
<p>where <span class="math notranslate nohighlight">\(A=4.5, B=3.5, C=1/6\)</span>.
We have chosen these constants so that the height of the hill (our reference length), <span class="math notranslate nohighlight">\(h=1\)</span>.
Note that, as <span class="math notranslate nohighlight">\(y \longrightarrow 3\)</span>, the perturbation, goes to zero.
So that near <span class="math notranslate nohighlight">\(y = 3\)</span>, the mesh recovers its original form.</p>
<p>In Nek5000, we can specify this through <code class="docutils literal notranslate"><span class="pre">usrdat2</span></code> in the <code class="docutils literal notranslate"><span class="pre">.usr</span></code> file as follows.
The first highlighted line shows where the mesh is deformed.
The second set of highlighted lines are used to set a forced flowrate.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">usrdat2</span><span class="p">()</span>
      <span class="k">implicit none</span>
<span class="k">      include</span> <span class="s1">&#39;SIZE&#39;</span>
      <span class="k">include</span> <span class="s1">&#39;TOTAL&#39;</span>
      
      <span class="kt">integer </span><span class="n">ntot</span><span class="p">,</span><span class="n">i</span>
      <span class="kt">real </span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">C</span><span class="p">,</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">argx</span><span class="p">,</span><span class="n">A1</span>
      
      <span class="n">ntot</span> <span class="o">=</span> <span class="n">lx1</span><span class="o">*</span><span class="n">ly1</span><span class="o">*</span><span class="n">lz1</span><span class="o">*</span><span class="n">nelt</span>
      
      <span class="n">A</span>   <span class="o">=</span> <span class="mf">4.5</span>
      <span class="n">B</span>   <span class="o">=</span> <span class="mf">3.5</span>
      <span class="n">C</span>   <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="mi">6</span>
      
      <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ntot</span>
         <span class="n">xx</span>   <span class="o">=</span> <span class="n">xm1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">yy</span>   <span class="o">=</span> <span class="n">ym1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">argx</span> <span class="o">=</span> <span class="n">B</span><span class="o">*</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">xx</span><span class="o">-</span><span class="n">A</span><span class="p">)</span><span class="o">-</span><span class="n">B</span><span class="p">)</span>
         <span class="n">A1</span>   <span class="o">=</span> <span class="n">C</span> <span class="o">+</span> <span class="n">C</span><span class="o">*</span><span class="nb">tanh</span><span class="p">(</span><span class="n">argx</span><span class="p">)</span>
<span class="hll">         <span class="n">ym1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">yy</span> <span class="o">+</span> <span class="p">(</span><span class="mi">3</span><span class="o">-</span><span class="n">yy</span><span class="p">)</span><span class="o">*</span><span class="n">A1</span>
</span>      <span class="n">enddo</span>
      
      <span class="c">! apply mass flux to drive the flow such that Ubar = 1</span>
<span class="hll">      <span class="n">param</span><span class="p">(</span><span class="mi">54</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>   <span class="c">! x-direction</span>
</span><span class="hll">      <span class="n">param</span><span class="p">(</span><span class="mi">55</span><span class="p">)</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c">! Ubar</span>
</span>      
      <span class="k">return</span>
<span class="k">      end</span>
</pre></div>
</div>
<p>By modifying the mesh in <code class="docutils literal notranslate"><span class="pre">usrdat2</span></code>, the modification is applied to the GLL points directly.
This allows the mesh to conform to the specified profile to <span class="math notranslate nohighlight">\(N^{th}\)</span>-order accuracy.
The deformed mesh with the GLL points is shown below.</p>
<div class="align-center figure" id="id2">
<img alt="per_mesh" src="../_images/hillpmesh.png" />
<p class="caption"><span class="caption-text">Modified box mesh graded</span></p>
</div>
</div>
<div class="section" id="initial-boundary-conditions">
<h3>Initial &amp; boundary conditions<a class="headerlink" href="#initial-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>The next step is to specify the initial conditions.
This can be done in the subroutine <code class="docutils literal notranslate"><span class="pre">useric</span></code> as follows:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span>      <span class="k">subroutine </span><span class="n">useric</span><span class="p">(</span><span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">,</span><span class="n">iz</span><span class="p">,</span><span class="n">ieg</span><span class="p">)</span>
      <span class="k">implicit none</span>
<span class="k">      include</span> <span class="s1">&#39;SIZE&#39;</span>
      <span class="k">include</span> <span class="s1">&#39;TOTAL&#39;</span>
      <span class="k">include</span> <span class="s1">&#39;NEKUSE&#39;</span>
      
      <span class="kt">integer </span><span class="n">ix</span><span class="p">,</span><span class="n">iy</span><span class="p">,</span><span class="n">iz</span><span class="p">,</span><span class="n">ieg</span>
      
      <span class="n">ux</span>   <span class="o">=</span> <span class="mf">1.0</span>
      <span class="n">uy</span>   <span class="o">=</span> <span class="mf">0.0</span>
      <span class="n">uz</span>   <span class="o">=</span> <span class="mf">0.0</span>
      <span class="n">temp</span> <span class="o">=</span> <span class="mf">0.0</span>
      
      <span class="k">return</span>
<span class="k">      end</span>
</pre></div>
</div>
<p>For walls and periodic boundaries, nothing needs to be specified in the user file, so <code class="docutils literal notranslate"><span class="pre">userbc</span></code> can remain unmodified.</p>
</div>
</div>
<div class="section" id="control-parameters">
<h2>Control parameters<a class="headerlink" href="#control-parameters" title="Permalink to this headline">¶</a></h2>
<p>The control parameters for any case are given in the <code class="docutils literal notranslate"><span class="pre">.par</span></code> file.
For this case, using any text editor, create a new file called <code class="docutils literal notranslate"><span class="pre">hillp.par</span></code> and type in the following</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nek5000 parameter file</span>
<span class="p">[</span><span class="n">GENERAL</span><span class="p">]</span>
<span class="n">stopAt</span> <span class="o">=</span> <span class="n">endTime</span>
<span class="n">endTime</span>  <span class="o">=</span> <span class="mi">200</span>

<span class="n">variableDT</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">targetCFL</span> <span class="o">=</span> <span class="mf">0.4</span>
<span class="n">timeStepper</span> <span class="o">=</span> <span class="n">bdf2</span>

<span class="n">writeControl</span> <span class="o">=</span> <span class="n">runTime</span>
<span class="n">writeInterval</span> <span class="o">=</span> <span class="mi">20</span>

<span class="p">[</span><span class="n">PROBLEMTYPE</span><span class="p">]</span>
<span class="n">equation</span> <span class="o">=</span> <span class="n">incompNS</span>

<span class="p">[</span><span class="n">PRESSURE</span><span class="p">]</span>
<span class="n">residualTol</span> <span class="o">=</span> <span class="mf">1e-5</span>
<span class="n">residualProj</span> <span class="o">=</span> <span class="n">yes</span>

<span class="p">[</span><span class="n">VELOCITY</span><span class="p">]</span>
<span class="n">residualTol</span> <span class="o">=</span> <span class="mf">1e-8</span>
<span class="n">density</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">viscosity</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
</pre></div>
</div>
<p>In choosing <code class="docutils literal notranslate"><span class="pre">viscosity</span> <span class="pre">=</span> <span class="pre">-100</span></code> we are actually setting the Reynolds number. This assumes that
<span class="math notranslate nohighlight">\(\rho \times u_b \times h = 1\)</span> where <span class="math notranslate nohighlight">\(u_b\)</span> denotes the bulk velocity and <span class="math notranslate nohighlight">\(h\)</span> the hill height.</p>
<p>We have set the calculation to stop at the physical time of <span class="math notranslate nohighlight">\(T=200\)</span> (<code class="docutils literal notranslate"><span class="pre">endTime=200</span></code>) which is roughly 22 flow-thru time units (based on the bulk velocity <span class="math notranslate nohighlight">\(u_b\)</span> and length of periodic pitch, <span class="math notranslate nohighlight">\(L=9\)</span>).  Additional details on the names of keys in the <code class="docutils literal notranslate"><span class="pre">.par</span></code> file can be found <a class="reference internal" href="../problem_setup/case_files.html#case-files-par"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="section" id="size-file">
<h2>SIZE file<a class="headerlink" href="#size-file" title="Permalink to this headline">¶</a></h2>
<p>The static memory layout of Nek5000 requires the user to set some solver parameters through a so called <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> file.
Typically it’s a good idea to start from our template.
Copy the <code class="docutils literal notranslate"><span class="pre">SIZE.template</span></code> file from the core directory and rename it <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> in the working directory:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> cp <span class="nv">$HOME</span>/Nek5000/core/SIZE.template SIZE
</pre></div>
</div>
<p>Then, adjust the following parameters in the BASIC section</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span>      <span class="c">! BASIC</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">ldim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>               <span class="c">! domain dimension (2 or 3)</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">lx1</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>                <span class="c">! GLL points per element along each direction</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">lxd</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>               <span class="c">! GL  points for over-integration (dealiasing) </span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">lx2</span><span class="o">=</span><span class="n">lx1</span><span class="o">-</span><span class="mi">0</span><span class="p">)</span>            <span class="c">! GLL points for pressure (lx1 or lx1-2)</span>
                                     
      <span class="k">parameter</span> <span class="p">(</span><span class="n">lelg</span><span class="o">=</span><span class="mi">22</span><span class="o">*</span><span class="mi">8</span><span class="p">)</span>            <span class="c">! max number of global elements</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">lpmin</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>              <span class="c">! min number of MPI ranks </span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">lelt</span><span class="o">=</span><span class="n">lelg</span><span class="o">/</span><span class="n">lpmin</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>  <span class="c">! max number of local elements per MPI rank</span>
      <span class="k">parameter</span> <span class="p">(</span><span class="n">ldimt</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>              <span class="c">! max auxiliary fields (temperature + scalars)</span>
</pre></div>
</div>
<p>For this tutorial we have set our polynomial order to be <span class="math notranslate nohighlight">\(N=7\)</span> - this is defined in the <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> file above as <code class="docutils literal notranslate"><span class="pre">lx1=8</span></code> which indices that there are 8 points in each spatial dimension of every element.
Additional details on the parameters in the <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> file are given <a class="reference internal" href="../problem_setup/case_files.html#case-files-size"><span class="std std-ref">here</span></a>.</p>
</div>
<div class="section" id="compilation">
<h2>Compilation<a class="headerlink" href="#compilation" title="Permalink to this headline">¶</a></h2>
<p>With the <code class="docutils literal notranslate"><span class="pre">hillp.usr</span></code>, and <code class="docutils literal notranslate"><span class="pre">SIZE</span></code> files created, you should now be all set to compile and run your case!
As a final check, you should have the following files:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference download internal" download="" href="../_downloads/e4b062ae66e4400efcd63cbeb6b819ed/hillp.usr"><code class="xref download docutils literal notranslate"><span class="pre">hillp.usr</span></code></a></li>
<li><a class="reference download internal" download="" href="../_downloads/5349a3b951a017779a5d9a88a5438dd6/hillp.par"><code class="xref download docutils literal notranslate"><span class="pre">hillp.par</span></code></a></li>
<li><a class="reference download internal" download="" href="../_downloads/f553de6c758186b45f00d18720544661/hillp.re2"><code class="xref download docutils literal notranslate"><span class="pre">hillp.re2</span></code></a></li>
<li><a class="reference download internal" download="" href="../_downloads/04f507701c248acc022696890e54ee23/hillp.ma2"><code class="xref download docutils literal notranslate"><span class="pre">hillp.ma2</span></code></a></li>
<li><a class="reference download internal" download="" href="../_downloads/ee8e92a67ddbde6348465d828dfc7d17/SIZE"><code class="xref download docutils literal notranslate"><span class="pre">SIZE</span></code></a></li>
</ul>
</div></blockquote>
<p>If for some reason you encountered an insurmountable error and were unable to generate any of the required files, you may use the provided links to download them.
After confirming that you have all five, you are now ready to compile</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> makenek hillp
</pre></div>
</div>
<p>If all works properly, upon compilation the executable <code class="docutils literal notranslate"><span class="pre">nek5000</span></code> will be generated.</p>
</div>
<div class="section" id="running-the-case">
<h2>Running the case<a class="headerlink" href="#running-the-case" title="Permalink to this headline">¶</a></h2>
<p>First we need to run our domain paritioning tool</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> genmap
</pre></div>
</div>
<p>On input specify <code class="docutils literal notranslate"><span class="pre">hillp</span></code> as your casename and press enter to use the default tolerance. This step will produce <code class="docutils literal notranslate"><span class="pre">hillp.ma2</span></code> which needs to be generated only once.</p>
<p>Now you are all set, just run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> nekbmpi hillp <span class="m">4</span>
</pre></div>
</div>
<p>to launch an MPI jobs on your local machine using 4 ranks. The output will be redirected to <code class="docutils literal notranslate"><span class="pre">logfile</span></code>.</p>
</div>
<div class="section" id="post-processing-the-results">
<h2>Post-processing the results<a class="headerlink" href="#post-processing-the-results" title="Permalink to this headline">¶</a></h2>
<p>Once execution is completed your directory should now contain multiple checkpoint files that look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hillp</span><span class="o">.</span><span class="n">f00001</span>
<span class="n">hillp</span><span class="o">.</span><span class="n">f00002</span>
<span class="o">...</span>
</pre></div>
</div>
<p>The preferred mode for data visualization and analysis with Nek5000 is
to use Visit/Paraview. One can use the script <em>visnek</em>, to be found in <code class="docutils literal notranslate"><span class="pre">/scripts</span></code>. It is sufficent to run</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> visnek hillp
</pre></div>
</div>
<p><em>(or the name of your session)</em> to obatain a file named <code class="docutils literal notranslate"><span class="pre">hillp.nek5000</span></code> which can be recognized in Visit/Paraview.</p>
<p>In the viewing window one can visualize the flow-field.</p>
<div class="align-center figure" id="id3">
<img alt="per_flow" src="../_images/hill_flow_v3.png" />
<p class="caption"><span class="caption-text">Visualization of the steady-state flow field. Vectors represent velocity. Colors represent velocity magnitude. Note, velocity vectors are equal size and not scaled by magnitude.</span></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2015-2023, UCHICAGO ARGONNE, LLC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>